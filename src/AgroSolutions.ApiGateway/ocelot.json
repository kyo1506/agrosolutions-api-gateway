{
  "Routes": [
    {
      "Key": "identity-login",
      "DownstreamPathTemplate": "/v1/login",
      "DownstreamScheme": "http",
      "DownstreamHostAndPorts": [{ "Host": "agrosolutions-identity-api", "Port": 80 }],
      "UpstreamPathTemplate": "/identity/v1/login",
      "UpstreamHttpMethod": ["POST"],
      "RateLimitOptions": { "EnableRateLimiting": true, "Period": "1m", "Limit": 30 },
      "QoSOptions": { "ExceptionsAllowedBeforeBreaking": 3, "DurationOfBreak": 30000, "TimeoutValue": 10000 }
    },
    {
      "Key": "identity-register",
      "DownstreamPathTemplate": "/v1/register",
      "DownstreamScheme": "http",
      "DownstreamHostAndPorts": [{ "Host": "agrosolutions-identity-api", "Port": 80 }],
      "UpstreamPathTemplate": "/identity/v1/register",
      "UpstreamHttpMethod": ["POST"],
      "RateLimitOptions": { "EnableRateLimiting": true, "Period": "1m", "Limit": 20 },
      "QoSOptions": { "ExceptionsAllowedBeforeBreaking": 3, "DurationOfBreak": 30000, "TimeoutValue": 10000 }
    },
    {
      "Key": "identity-users-list",
      "DownstreamPathTemplate": "/v1/users",
      "DownstreamScheme": "http",
      "DownstreamHostAndPorts": [{ "Host": "agrosolutions-identity-api", "Port": 80 }],
      "UpstreamPathTemplate": "/identity/v1/users",
      "UpstreamHttpMethod": ["GET"],
      "AuthenticationOptions": { "AuthenticationProviderKey": "Bearer" },
      "RouteClaimsRequirement": { "scope": "users:manage" },
      "RateLimitOptions": { "EnableRateLimiting": true, "Period": "1m", "Limit": 100 },
      "QoSOptions": { "ExceptionsAllowedBeforeBreaking": 3, "DurationOfBreak": 30000, "TimeoutValue": 10000 }
    },
    {
      "Key": "identity-user-get-by-id",
      "DownstreamPathTemplate": "/v1/users/{id}",
      "DownstreamScheme": "http",
      "DownstreamHostAndPorts": [{ "Host": "agrosolutions-identity-api", "Port": 80 }],
      "UpstreamPathTemplate": "/identity/v1/users/{id}",
      "UpstreamHttpMethod": ["GET"],
      "Priority": 1,
      "AuthenticationOptions": { "AuthenticationProviderKey": "Bearer" },
      "RouteClaimsRequirement": { "scope": "users:read" },
      "RateLimitOptions": { "EnableRateLimiting": true, "Period": "1m", "Limit": 100 },
      "QoSOptions": { "ExceptionsAllowedBeforeBreaking": 3, "DurationOfBreak": 30000, "TimeoutValue": 10000 }
    },
    {
      "Key": "identity-user-update",
      "DownstreamPathTemplate": "/v1/users/{id}",
      "DownstreamScheme": "http",
      "DownstreamHostAndPorts": [{ "Host": "agrosolutions-identity-api", "Port": 80 }],
      "UpstreamPathTemplate": "/identity/v1/users/{id}",
      "UpstreamHttpMethod": ["PUT"],
      "Priority": 1,
      "AuthenticationOptions": { "AuthenticationProviderKey": "Bearer" },
      "RouteClaimsRequirement": { "scope": "users:manage" },
      "RateLimitOptions": { "EnableRateLimiting": true, "Period": "1m", "Limit": 100 },
      "QoSOptions": { "ExceptionsAllowedBeforeBreaking": 3, "DurationOfBreak": 30000, "TimeoutValue": 10000 }
    },
    {
      "Key": "identity-user-delete",
      "DownstreamPathTemplate": "/v1/users/{id}",
      "DownstreamScheme": "http",
      "DownstreamHostAndPorts": [{ "Host": "agrosolutions-identity-api", "Port": 80 }],
      "UpstreamPathTemplate": "/identity/v1/users/{id}",
      "UpstreamHttpMethod": ["DELETE"],
      "Priority": 1,
      "AuthenticationOptions": { "AuthenticationProviderKey": "Bearer" },
      "RouteClaimsRequirement": { "scope": "users:manage" },
      "RateLimitOptions": { "EnableRateLimiting": true, "Period": "1m", "Limit": 100 },
      "QoSOptions": { "ExceptionsAllowedBeforeBreaking": 3, "DurationOfBreak": 30000, "TimeoutValue": 10000 }
    },
    {
      "Key": "identity-profile",
      "DownstreamPathTemplate": "/v1/profile",
      "DownstreamScheme": "http",
      "DownstreamHostAndPorts": [{ "Host": "agrosolutions-identity-api", "Port": 80 }],
      "UpstreamPathTemplate": "/identity/v1/profile",
      "UpstreamHttpMethod": ["GET", "PUT"],
      "AuthenticationOptions": { "AuthenticationProviderKey": "Bearer" },
      "RouteClaimsRequirement": { "scope": "profiles:manage" },
      "RateLimitOptions": { "EnableRateLimiting": true, "Period": "1m", "Limit": 100 },
      "QoSOptions": { "ExceptionsAllowedBeforeBreaking": 3, "DurationOfBreak": 30000, "TimeoutValue": 10000 }
    },
    {
      "Key": "ingestao-sensor",
      "DownstreamPathTemplate": "/api/ingestion/sensor",
      "DownstreamScheme": "http",
      "DownstreamHostAndPorts": [{ "Host": "agrosolutions-ingestion-api", "Port": 80 }],
      "UpstreamPathTemplate": "/ingestao/sensor",
      "UpstreamHttpMethod": ["POST"],
      "RateLimitOptions": { "EnableRateLimiting": true, "Period": "1s", "Limit": 5000 },
      "QoSOptions": { "ExceptionsAllowedBeforeBreaking": 10, "DurationOfBreak": 5000, "TimeoutValue": 3000 },
      "LoadBalancerOptions": { "Type": "LeastConnection" }
    },
    {
      "Key": "properties-read",
      "DownstreamPathTemplate": "/v1/{everything}",
      "DownstreamScheme": "http",
      "DownstreamHostAndPorts": [{ "Host": "agrosolutions-properties-api", "Port": 80 }],
      "UpstreamPathTemplate": "/properties/v1/{everything}",
      "UpstreamHttpMethod": ["GET"],
      "AuthenticationOptions": { "AuthenticationProviderKey": "Bearer" },
      "RouteClaimsRequirement": { "scope": "users:read" },
      "RateLimitOptions": { "EnableRateLimiting": true, "Period": "1m", "Limit": 200 },
      "QoSOptions": { "ExceptionsAllowedBeforeBreaking": 3, "DurationOfBreak": 30000, "TimeoutValue": 10000 },
      "LoadBalancerOptions": { "Type": "RoundRobin" }
    },
    {
      "Key": "properties-write",
      "DownstreamPathTemplate": "/v1/{everything}",
      "DownstreamScheme": "http",
      "DownstreamHostAndPorts": [{ "Host": "agrosolutions-properties-api", "Port": 80 }],
      "UpstreamPathTemplate": "/properties/v1/{everything}",
      "UpstreamHttpMethod": ["POST", "PUT", "DELETE"],
      "AuthenticationOptions": { "AuthenticationProviderKey": "Bearer" },
      "RouteClaimsRequirement": { "scope": "users:manage" },
      "RateLimitOptions": { "EnableRateLimiting": true, "Period": "1m", "Limit": 100 },
      "QoSOptions": { "ExceptionsAllowedBeforeBreaking": 3, "DurationOfBreak": 30000, "TimeoutValue": 10000 },
      "LoadBalancerOptions": { "Type": "RoundRobin" }
    }
  ],
  "GlobalConfiguration": {
    "BaseUrl": "http://localhost:5000",
    "RateLimitOptions": {
      "DisableRateLimitHeaders": false,
      "QuotaExceededMessage": "Rate limit exceeded. Please try again later.",
      "HttpStatusCode": 429,
      "ClientIdHeader": "X-Forwarded-For"
    }
  }
}
