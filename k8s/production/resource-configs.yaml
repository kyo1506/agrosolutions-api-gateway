---
# Resource Quotas for API Gateway Namespace
apiVersion: v1
kind: ResourceQuota
metadata:
  name: agrosolutions-gateway-quota
  namespace: agrosolutions-gateway
spec:
  hard:
    requests.cpu: "600m"      # 2 replicas × 200m + headroom
    requests.memory: 768Mi    # 2 replicas × 256Mi + headroom
    limits.cpu: "1100m"       # 2 replicas × 500m + headroom
    limits.memory: 1280Mi     # 2 replicas × 512Mi + headroom

---
# Limit Ranges for API Gateway Pods
apiVersion: v1
kind: LimitRange
metadata:
  name: agrosolutions-gateway-limits
  namespace: agrosolutions-gateway
spec:
  limits:
    - max:
        cpu: "500m"
        memory: 512Mi
      min:
        cpu: "50m"
        memory: 64Mi
      default:
        cpu: "200m"
        memory: 256Mi
      defaultRequest:
        cpu: "100m"
        memory: 128Mi
      type: Container

---
# PodDisruptionBudget for API Gateway
apiVersion: policy/v1
kind: PodDisruptionBudget
metadata:
  name: api-gateway-pdb
  namespace: agrosolutions-gateway
spec:
  minAvailable: 1
  selector:
    matchLabels:
      app: api-gateway
